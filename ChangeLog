2009-11-28	Bogdan Drozdowski <bogdandr@op.pl>

	* WipeFreeSpace version 1.2
	  MinixFS version 1 and 2 now supported.
	* configure.ac: fixed command-line parameter "--enable-random-method".
	* wipefreespace.c (main): fixed command-line parameters --iterations,
	  --blocksize and --superblock.
	* wfs_util.c (wfs_create_child): now returning error if fork() is not
	  available.
	* wfs_xfs.c: using a better preprocessor check for the availability
	  of the select() function.
	* wfs_minixfs.{c,h}: MinixFS version 1 and 2 support.
	* wfs_ntfs.c: prepare for using ntfswipe in the future.
	* README, wipefreespace.1, wipefreespace.texi.in, configure.ac,
	  wipefreespace.spec.in, wfs_wrappers.c, INSTALL: MinixFS support.
	* wfs_ext234.c (wfs_e234_wipe_journal): added test if feature checking
	  and the journal feature are defined.

2009-04-25	Bogdan Drozdowski <bogdandr@op.pl>

	* WipeFreeSpace version 1.1
	  Renamed wfs_ext23.* to wfs_ext234.*. Better closing routines for
	  some filesystems. FAT12/16/32 support. Using binary opening mode, if
	  available. New command-line options: '--last-zero' causes an
	  additional wiping with zeros to be performed, '--all-zeros' causes
	  the program to use only zero bits for wiping. Added progress bars
	  visible in verbose mode.
	* wipefreespace.c (main): displaying libraries' version numbers along
	  with the program's version number, fixed error checking after strtoul
	  in command line parsing. No longer relying on getopt_long(). Now
	  forking before calling the wiping function.
	* Makefile.am: fixed making the package.
	* docs, help: updated the number of passes, added '--last-zero' and
	  '--all-zeros'.
	* wipefreespace.1: added thanks, added '--last-zero' and '--all-zeros'
	* wipefreespace.texi.in: removed the "indicateurl" tag, for better
	  compatibility with OpenBSD's makeinfo, added '--last-zero' and
	  '--all-zeros'.
	* INSTALL, wipefreespace.spec, README: update
	* wipefreespace.h: Missing type 'dev_t' disables ext2/3/4 instead of
	  making an error. Removed some of the warnings caused by ReiserFS3/4
	  include files.
	* configure.ac: The 'dev_t' type now required for ext2/3/4. Added -O2
	  to detected compiler flags. The getopt.h header and getopt_long()
	  function are no longer required.
	* wfs_signal.c: better checking for defined signals, defining the
	  signal variables unconditionally.
	* wfs_signal.c (child_signal_received): fixed checking return type.
	* wfs_signal.c (wfs_set_sigh): Fixed SIGCHLD in wrong places, fixed
	  too many arguments for one signal() call.
	* wipefreespace.c: added including sys/ioctl.h.
	* wfs_reiser4.c: better initializing some return-code variables.
	* wfs_cfg.h.in: Defining __attribute__(x) and __attribute(x) to empty
	  values if we're not using GCC (some headers use these constructs).
	  Added some missing entries.
	* wfs_fat.{c,h}: FAT12/16/32 support.
	* wfs_xfs.c: better maintenance of command arguments for the future.
	  Fixed problems with select() calls which could cause the program to
	  wait forever for data. Moved child process management to wfs_util.c.
	  Re-sending the commands to xfs_db processes if reading data timeouts.
	* wfs_xfs.c (wfs_xfs_open_fs): checking the filesystem's signature
	  first, because xfs_db eats many resources and can eventually crash
	  if the filesystem isn't XFS.
	* wfs_ntfs.c (wfs_ntfs_wipe_unrm): Wiping the journal fixed and now
	  wiping it even if wiping undelete data would not occur.
	* wfs_ext234.c (wfs_e234_wipe_unrm): Wiping the journal even if wiping
	  undelete data would not occur.
	* wfs_reiser4.c (wfs_r4_wipe_unrm): initializing tree root if NULL
	* wfs_util.{c,h}: added new functions for creating a child process
	  that executes a single command, waiting for child processes and
	  checking if a child process has already exited.

2008-09-28	Bogdan Drozdowski <bogdandr@op.pl>

	* WipeFreeSpace version 1.0
	  All files prefixed with "wfs_". Gutmann method as default. Fixed
	  some possibilities for wiping to be finished too early for some
	  blocks. ReiserFSv4 support. License reverted to GPLv2+, because of
	  linking with ReiserFSv3/4 libraries, which are GPLv2-only (read
	  http://www.gnu.org/licenses/gpl-faq.html#AllCompatibility). New
	  command-line option, --use-ioctl, allows to disable the device's
	  cache prior to wiping and bring it back to the previous state after
	  wiping. This can be dangerous (hdparm says so), so it's disabled by
	  default. Checked to compile against e2fsprogs-1.41.1. Works on the
	  ext4 filesystem. Changed the verbose mode output to include the
	  current filesystem in the second field.
	* configure.ac: portability - not relying on autoconf's variables
	  anymore. Automatically changing the version number in TeXinfo docs,
	  spec file and sources.
	* wfs_util.c: a new file for utility functions. Currently contains
	  functions used when checking if a filesystem is mounted.
	* docs: added a note about wiping damaged blocks. Added a note saying
	  that mntent.h is required for ReiserFSv3 and ReiserFSv4.
	* wipefreespace.h: turned wfs_fsid_t into a structure and put the
	  current filesystem name in it.
	* wfs_reiser.c (wfs_reiser_chk_mount): using wfs_check_mounted ()
	  instead of misc_dev_mounted() to avoid conflicts with reiser4.
	* wipefreespace.c (wfs_wipe_filesytem): zeroing out each used
	  structure before starting. Added the code to disable caches before
	  wiping. Forking before opening, so that ReiserFSv3 code can't
	  kill the whole program even during opening (when the filesystem type
	  is yet unknown) and errors in the old ntfsprogs-1.13 won't kill the
	  program on ntfs_unmount.
	* wfs_reiser.c (wfs_reiser_close_fs): setting the filesystem pointer
	  to NULL.
	* wfs_reiser.c: checking for NULL filesystem pointer in every function
	* src/Makefile.am: cleanup - not using separate libraries anymore.
	* wfs_reiser4.{c,h}: ReiserFSv4 support.
	* wfs_wrappers.c (wipe_unrm): fixed a problem where "elem" could be
	  used, but wasn't defined.
	* README: added a list of command-line options.
	* doc/wipefreespace.{1,texi}: updated error list, web addresses and
	  other corrections. New command line option added.
	* wipefreespace.c (main): removing dulpicate command-line parameters
	  (for thread safety).
	* wfs_xfs.c: now using select(), if available, to specify a waiting
	  time for input from child processes. If the child died, the program
	  will know it and leave instead of hanging waiting for data which
	  will never arrive.
	* wfs_cfg.h: separate glibc stuff from non-glibc.
	* wipefreespace.c, wfs_signal.c: the "verbose" option can now be
	  passed more than once. If one is given, only the operations will be
	  displayed. If two or more, both operatios and patterns used will be
	  displayed.
	* doc/wipefreespace.texi: Added a "Thanks" chapter.
	* wipefreespace.spec: Changed the URL, added more symbolic links,
	  added '-march=i386' to CFLAGS and fixed a few minor things.

2008-06-22	Bogdan Drozdowski <bogdandr@op.pl>

	* Wipefreespace version 0.9
	  Compatibility with non-ANSI C compilers. Journal wiping. Better XFS
	  support. Portability fixes. Better error checking.
	* configure.ac: Better portability. Less relying on autoconf
	  variables. Using a new macro to check compiler flags. XFS support
	  now requires the kill() function. Added new compiler options to
	  check for: -O1 -Wuninitialized, -Winit-self, -Wlogical-op,
	  -fstack-protector-all, -Wno-long-long.
	* wipefreespace.c: now using wfs_clear_cap()'s return error instead
	  of putting 1 always. Always flushing the filesystem before starting.
	  Colons removed from messages. A separate function for wiping one
	  file system. Fixed ReiserFS problem with both parent and child
	  returning instead of child closing; resetting sigchld_recvd.
	  Checking if filesystem's name isn't NULL. Always flushing the
	  filesystem after wiping. Changed displayed license to GPL>=3.
	* wfs_ext23.c: wiping the journal (when wiping undelete data).
	* wfs_ntfs.c: wiping the journal (when wiping undelete data) and
	  flushing it before starting. Compiles with ntfsprogs-2.0.
	* wfs_xfs.c (wfs_xfs_open_fs): checking the "inprogress" flag to see
	  if the filesystem isn't half-way created or fsck hasn't completed.
	  Checking for error if the given filesystem is not XFS.
	* wfs_xfs.c (wfs_xfs_check_err): better checking if something was read
	* wfs_xfs.c: set non-blocking mode only in check_err(), where no
	  output is possible. More error checking, especially with dup2().
	  Better waiting for child processes. Closing unused pipe ends.
	* wfs_xfs.c (wfs_xfs_wipe_part): Wiping partially used blocks.
	* wfs_ntfs.c (wfs_ntfs_is_dirty): fixed bug with the NVolWasDirty
	  macro. Big thanks to 'marlowe' for reporting.
	* wfs_ext23.c, wipefreespace.h: fixed bug with some inline e2fsprogs'
	  functions seen twice by some linkers. Again big thanks to 'marlowe'
	  for reporting.
	* secure.c (wfs_clear_cap): allocated storage released with cap_free.
	* secure.c (wfs_check_suid): change return type to errcode_enum.
	* THANKS: new file with a list of all the people I'd like to thank.
	* src/Makefile.am: fixed "make clean" not removing some libraries.
	* wipefreespace.h: #undefing ERR_MSG_FORMATL and ERR_MSG_FORMAT before
	  attempting to #define them.
	* wrappers.c (wfs_open_fs): returning error by default.

2008-01-12	Bogdan Drozdowski <bogdandr@op.pl>

	* Wipefreespace version 0.8
	  Big portability corrections. The program now compiles on OpenBSD.
	  Added ReiserFSv3.
	* wfs_xfs.c: using exit() in child processes. If waitpid() and wait()
	  not available, using SIGCHLD to wait for child processes (if
	  signals are enabled) and the old sleep+kill method (if signals
	  disabled). More checking for NULL. Comments for all the functions.
	* configure.ac: better portability. Printing summary. Checking for
	  sync(). Options for enabling only specific filesystems.
	* Makefile.am: added new macro and desktop file to EXTRA_DIST.
	* docs/info: telling about Konqueror context menu entry created with
	  the distributed desktop file, wipefreespace.desktop.
	* src/Makefile.am: getting rid of hard-coded CFLAGS.
	* wfs_ext23.{c,h}: new names for ext23.{c,h}.
	* wfs_ext23.c (e2_do_block): Better badblock list checking.
	* wfs_xfs.c (wfs_xfs_get_mnt_point): Slightly better portability.
	* wfs_reiser.{c,h}: ReiserFSv3 support. Docs updated with this info.
	* wrappers.c (wfs_open_fs): corrected NTFS part which had EXT2/3
	  elements.

2007-10-21	Bogdan Drozdowski <bogdandr@op.pl>

	* Version 0.7
	  More GNU Coding Style ('info standards'). More enum using.
	  Operating buffer is now local to each function, not global.
	* wipefreespace.c: new option: --background. Including copyright
	  info for used libraries. More portable signal checking. Typo fixed.
	  Ignoring empty arguments. Environment not cleared anymore (required
	  for XFS support).
	* wipefreespace.h: new enum entry CURR_NONE instead of using a zero
	  all the time.
	* wfs_ntfs.c (destroy_record): wiping deleted files' name's length
	  and data length (it won't be posiible to tell how long was the
	  file name and how much data was inside).
	* info doc: new option added. Full texts of the Licenses added. Added
	  a note saying that signal handling needs 'volatile' to work. Added
	  what to do if compiling fails. Added the SIGCHLD signal. Added XFS
	  info in compiling requirements. Added a chapter about filesystem
	  support.
	* ext23.c (e2_count_blocks): using parameters instead of globals.
	* ext23.c (e2_wipe_unrm_dir): zeroing deleted files' name's length.
	* configure.ac: Better portability.
	* wfs_ntfs.c: Memory leak fixed. Better parameters checking. Better
	  error handling.
	* wfs_signal.{c,h}: New files for signal-related stuff. Catching
	  (and ignoring) SIGCHLD.
	* wfs_ntfs.c, ext23.c: Sync() now only run in *_flush() functions.
	  Better parameters checking.
	* wfs_xfs.{c,h}: XFS filesystem support based on xfsprogs. Only free
	  space wiping is supported (no development library).
	* wrappers.c: ensuring an error code is set (not only by returning
	  values), when an error occurred.
	* README: added XFS info, some minor corrections.

2007-07-01	Bogdan Drozdowski <bogdandr@op.pl>

	* Version 0.6
	  Switch to autoconf+automake. Works great. Project rename
	  to 'wipefreespace'.
	* wipefreespace.c: Security: dropping capabilities and clearing
	  environment. Better error/message displaying routines.
	* secure.c: New file containing all security-related stuff.
	* wrappers.c: Fully filesystem-neutral. Better mount checking.
	* wipefreespace.h: New error_type definition. Less externs.
	* ext23.c: Flushing corrected and it shows error just once.
	* wfs_ntfs.{c,h}: NTFS support based on ntfsprogs, thus experimental.

2007-04-31	Bogdan Drozdowski <bogdandr@op.pl>

	* Version 0.5
	  Code rebuild: separate 3 source files (+headers), to allow
	  other file systems in the future. Info doc update. Man page.
	* e2wipefreespace.c:
	  Security fixes: setuid bit checking and snprintf(). Return
	  codes slightly changed. Translations enabled
	  (gettext)+Polish translation. Separate message printing
	  functions (easy changeable).
	* Makefile: updated with translation & manpage.
	* ext23.c (e2wipe_unrm_dir): corrected: "name_len & 255".

2007-04-10	Bogdan Drozdowski <bogdandr@op.pl>

	* Version 0.4
	  Finding last partially used buffer only if needed. More code
	  changes & cleanup. Added sync()ing after every writing,
	  if available. Three new options: --nopart, --nounrm, --nowfs.
	  Docs updated with signal information. Removing deleted files'
	  names fully works. Some Makefile updates - easy building RPMs.
	  Signals corrected and checked more often. Security: checking
	  stdout & stdin.

2007-04-08	Bogdan Drozdowski <bogdandr@op.pl>

	* Version 0.3
	  Various security fixes (checking of argc&argv and a safer
	  signal handler). New option --force makes the program continue
	  even if the file system contains errors. Separate function for
	  wiping blocks. Doc comments. Small code cleanup. Makefile upgrade
	  with the 'static' target and more warning options. More file
	  system checking. Wiping free space in partially used blocks.
	  Documentation (README & info) update. Includes compiled gzipped
	  'info' documentation. Block wiping corrected (flushing added).
	  Flushing verbose messages - in case of crashes the last message
	  shown is important for tracking.

2007-04-01	Bogdan Drozdowski <bogdandr@op.pl>

	* Version 0.2
	  Adds generating the error table. Adds flushing the file system
	  before starting if it's marked dirty or invalid. Adds a second
	  try for opening the file system, when exclusive access is
	  impossible. Adds a 'verbose' option. Makefile fixed.

2007-03-24	Bogdan Drozdowski <bogdandr@op.pl>

	* First release of e2wipefreespace, version 0.1.
	  Uses exclusive access, if possible. Checks if the file system is
	  mounted. Uses raw block access, no i-nodes. Uses patterns from
	  'shred', but has own random-generating code. Sets signal handlers.
	  Accepts 7 command-line options, 'license' being an alias for
	  'licence'.
