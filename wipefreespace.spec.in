# Special names here like {__make} come from /usr/lib/rpm/macros, /usr/lib/rpm/macros.rpmbuild

%define version @VERSION@
%define name wipefreespace
# define wfs_prefix /usr/local

Summary:	Program for secure cleaning of free space on file systems
Name:		%{name}
Version:	%{version}
Release:	1%{?dist}
URL:		http://wipefreespace.sf.net
License:	GPLv2
# group must be one of the listed in /usr/share/doc/rpm-.../GROUPS or /usr/share/rpmlint/config.d/distro.conf
Group:		Security
# Group:		System Utilities / Applications/System
# Packager:	Bogdan Drozdowski <bogdandr@op.pl>
# Prefix:		/usr/local
Source:		%{name}-%{version}.tar.gz
BuildRoot:	%{_tmppath}/%{name}-build
Requires:	xfsprogs
BuildRequires:	gcc, glibc, glibc-devel, make
Obsoletes:	e2wipefreespace <= 0.5
Provides:	e2wipefreespace >= 0.6

%description

Wipefreespace is a program which securely cleans free space on given
file systems, making confidential removed data recovery impossible. It also
removes deleted files' names, so that no trace is left. Supported file systems
are: ext2/3/4, NTFS, XFS, ReiserFSv3/4, FAT12/16/32, MinixFSv1/2, JFS, HFS+
and OCFS.

%prep
%setup -q
%configure

%build
#CFLAGS='-march=i386' ./configure --prefix= {wfs_prefix} --mandir=/usr/share/man \
#	--infodir=/usr/share/info --libdir= {wfs_prefix}/lib
#--mandir=$RPM_BUILD_ROOT/usr/local/man
#prefix=$RPM_BUILD_ROOT/usr/local
# {__make} 2>/dev/null

%make

%post
#install-info

%postun
#install-info

%install

%makeinstall_std

# {__mkdir_p} $RPM_BUILD_ROOT/usr/share/info
#prefix=$RPM_BUILD_ROOT/usr/local
# {__make} DESTDIR="$RPM_BUILD_ROOT" install-strip
# {__mv} -f $RPM_BUILD_ROOT/usr/share/locale/pl/LC_MESSAGES/wipefreespace.mo \
#	$RPM_BUILD_ROOT {wfs_prefix}/share/locale/pl/LC_MESSAGES/wipefreespace.mo
# {__rm} -f $RPM_BUILD_ROOT/usr/bin/wipefreespace*
# {__rm} -f $RPM_BUILD_ROOT {wfs_prefix}/info/wipefreespace.info*
# {__rm} -f $RPM_BUILD_ROOT {wfs_prefix}/man/man1/wipefreespace.1*
# {__rm} -f $RPM_BUILD_ROOT {wfs_prefix}/share/info/wipefreespace.info*
# {__rm} -f $RPM_BUILD_ROOT {wfs_prefix}/share/man/man1/wipefreespace.1*
# {__rm} -f $RPM_BUILD_ROOT {wfs_wfs_prefix}/share/locale/pl/LC_MESSAGES/wipefreespace.mo
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/e2wipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/e3wipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/e4wipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/ntfswipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/xfswipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/reiserwipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/reiser4wipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/fatwipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/vfatwipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/minixwipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/minix1wipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/minix2wipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/jfswipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/hfspwipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/hfswipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/ocfswipefreespace
%{__ln_s} %{_bindir}/wipefreespace $RPM_BUILD_ROOT/%{_bindir}/ocfs2wipefreespace

%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/e2wipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/e3wipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/e4wipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/ntfswipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/xfswipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/reiserwipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/reiser4wipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/fatwipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/vfatwipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/minixwipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/minix1wipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/minix2wipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/jfswipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/hfspwipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/hfswipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/ocfswipefreespace.1%_extension
%{__ln_s} %{_mandir}/man1/wipefreespace.1%_extension $RPM_BUILD_ROOT/%{_mandir}/man1/ocfs2wipefreespace.1%_extension
# {__mv} -f $RPM_BUILD_ROOT/usr/bin/wipefreespace $RPM_BUILD_ROOT {wfs_prefix}/bin/wipefreespace
# {makeinstall}

%clean

%{__rm} -rf $RPM_BUILD_ROOT

%define _unpackaged_files_terminate_build 0
%files

%defattr(-,root,root)
%{_bindir}/wipefreespace
%{_bindir}/e2wipefreespace
%{_bindir}/e3wipefreespace
%{_bindir}/e4wipefreespace
%{_bindir}/ntfswipefreespace
%{_bindir}/xfswipefreespace
%{_bindir}/reiserwipefreespace
%{_bindir}/reiser4wipefreespace
%{_bindir}/fatwipefreespace
%{_bindir}/vfatwipefreespace
%{_bindir}/minixwipefreespace
%{_bindir}/minix1wipefreespace
%{_bindir}/minix2wipefreespace
%{_bindir}/jfswipefreespace
%{_bindir}/hfspwipefreespace
%{_bindir}/hfswipefreespace
%{_bindir}/ocfswipefreespace
%{_bindir}/ocfs2wipefreespace
%doc %{_infodir}/wipefreespace.info%_extension
%doc %{_mandir}/man1/wipefreespace.1%_extension
%doc %{_mandir}/man1/e2wipefreespace.1%_extension
%doc %{_mandir}/man1/e3wipefreespace.1%_extension
%doc %{_mandir}/man1/e4wipefreespace.1%_extension
%doc %{_mandir}/man1/ntfswipefreespace.1%_extension
%doc %{_mandir}/man1/xfswipefreespace.1%_extension
%doc %{_mandir}/man1/reiserwipefreespace.1%_extension
%doc %{_mandir}/man1/reiser4wipefreespace.1%_extension
%doc %{_mandir}/man1/fatwipefreespace.1%_extension
%doc %{_mandir}/man1/vfatwipefreespace.1%_extension
%doc %{_mandir}/man1/minixwipefreespace.1%_extension
%doc %{_mandir}/man1/minix1wipefreespace.1%_extension
%doc %{_mandir}/man1/minix2wipefreespace.1%_extension
%doc %{_mandir}/man1/jfswipefreespace.1%_extension
%doc %{_mandir}/man1/hfspwipefreespace.1%_extension
%doc %{_mandir}/man1/hfswipefreespace.1%_extension
%doc %{_mandir}/man1/ocfswipefreespace.1%_extension
%doc %{_mandir}/man1/ocfs2wipefreespace.1%_extension
%doc README
%doc COPYING
%doc AUTHORS
%doc ChangeLog
%{_localedir}/pl/LC_MESSAGES/wipefreespace.mo %lang(pl)
%{_localedir}/en@boldquot/LC_MESSAGES/wipefreespace.mo %lang(en)
%{_localedir}/en@quot/LC_MESSAGES/wipefreespace.mo %lang(en)

%changelog
